(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-565b1188"],{"0ab7":function(t,e,i){"use strict";i("e2cd")},"0d56":function(t,e,i){"use strict";i("dbeb")},1148:function(t,e,i){"use strict";var r=i("a691"),n=i("1d80");t.exports=function(t){var e=String(n(this)),i="",o=r(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(i+=e);return i}},"25f0":function(t,e,i){"use strict";var r=i("6eeb"),n=i("825a"),o=i("d039"),a=i("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),f=l.name!=s;(u||f)&&r(RegExp.prototype,s,(function(){var t=n(this),e=String(t.source),i=t.flags,r=String(void 0===i&&t instanceof RegExp&&!("flags"in c)?a.call(t):i);return"/"+e+"/"+r}),{unsafe:!0})},"408a":function(t,e,i){var r=i("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var r=i("1d80"),n=i("5899"),o="["+n+"]",a=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),c=function(t){return function(e){var i=String(r(e));return 1&t&&(i=i.replace(a,"")),2&t&&(i=i.replace(s,"")),i}};t.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(t,e,i){var r=i("861d"),n=i("d2bb");t.exports=function(t,e,i){var o,a;return n&&"function"==typeof(o=e.constructor)&&o!==i&&r(a=o.prototype)&&a!==i.prototype&&n(t,a),t}},"7db0":function(t,e,i){"use strict";var r=i("23e7"),n=i("b727").find,o=i("44d2"),a="find",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),o(a)},"80f9":function(t,e,i){"use strict";i("eec7")},a434:function(t,e,i){"use strict";var r=i("23e7"),n=i("23cb"),o=i("a691"),a=i("50c4"),s=i("7b0b"),c=i("65f0"),l=i("8418"),u=i("1dde"),f=u("splice"),d=Math.max,m=Math.min,h=9007199254740991,p="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(t,e){var i,r,u,f,g,v,b=s(this),_=a(b.length),y=n(t,_),w=arguments.length;if(0===w?i=r=0:1===w?(i=0,r=_-y):(i=w-2,r=m(d(o(e),0),_-y)),_+i-r>h)throw TypeError(p);for(u=c(b,r),f=0;f<r;f++)g=y+f,g in b&&l(u,f,b[g]);if(u.length=r,i<r){for(f=y;f<_-r;f++)g=f+r,v=f+i,g in b?b[v]=b[g]:delete b[v];for(f=_;f>_-r+i;f--)delete b[f-1]}else if(i>r)for(f=_-r;f>y;f--)g=f+r-1,v=f+i-1,g in b?b[v]=b[g]:delete b[v];for(f=0;f<i;f++)b[f+y]=arguments[f+2];return b.length=_-r+i,u}})},a890:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"inventory-layout"},[i("layout-top",{staticStyle:{"z-index":"1000"},attrs:{name:"方案报价清单",backTo:"/home/design-list"}},[i("a-button",{staticStyle:{"font-size":".13rem",height:".3rem"},attrs:{type:"primary",size:"small"},on:{click:t.saveUserOffer}},[t._v("保存报价 ")])],1),i("div",{staticClass:"inventory-content"},[i("a-drawer",{staticStyle:{"z-index":"10000000"},attrs:{title:"新增辅料人工",placement:"right",closable:!1,visible:t.showSelect,"get-container":!1,"wrap-style":{position:"absolute"}},on:{close:t.onClose}},[t.showSelect?i("div",{staticStyle:{display:"inline"}},[i("a-select",{staticStyle:{width:"100%",height:".25rem"},attrs:{placeholder:"新增辅料人工",size:"default"},on:{change:t.handleChange}},t._l(t.fuliaoList,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1),i("div",{directives:[{name:"show",rawName:"v-show",value:this.filiaoId,expression:"this.filiaoId"}],staticStyle:{margin:"0px auto",width:"100%","margin-top":"70%"}},[i("a-button",{staticStyle:{"font-size":".12rem",height:".25rem","margin-left":"10px"},attrs:{type:"primary"},on:{click:t.handleConfirm}},[t._v("确认")]),i("a-button",{staticStyle:{"font-size":".12rem",height:".25rem","margin-left":"10px"},attrs:{type:"danger"},on:{click:t.handleCancel}},[t._v("取消")])],1)],1):t._e()]),t.showEdit&&t.init?i("div",{staticClass:"add-table"},[i("div",{staticClass:"input-container"},[i("a-input",{staticStyle:{width:"2rem","margin-right":"20px","font-size":".15rem","/*! color":"#000 !important"},attrs:{placeholder:"输入客户姓名"},model:{value:t.temp.customer_name,callback:function(e){t.$set(t.temp,"customer_name",e)},expression:"temp.customer_name"}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.3)"},attrs:{slot:"prefix",type:"solution"},slot:"prefix"})],1),i("a-input",{staticStyle:{width:"2rem","margin-right":"20px","font-size":".13rem","/*! color":"#000 !important"},attrs:{placeholder:"输入客户电话",type:"tel"},model:{value:t.temp.customer_mobile,callback:function(e){t.$set(t.temp,"customer_mobile",e)},expression:"temp.customer_mobile"}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.3)"},attrs:{slot:"prefix",type:"phone",rotate:120},slot:"prefix"})],1)],1),i("a-button",{staticStyle:{"font-size":".12rem",height:".25rem",padding:".1rem","line-height":".05rem"},attrs:{type:"danger"},on:{click:t.handleOpenAdd}},[t._v("新增辅料人工")])],1):t._e(),i("a-table",{attrs:{columns:t.columns,"data-source":t.productList,pagination:!1,bordered:"",rowKey:function(t,e){return e}},scopedSlots:t._u([{key:"image",fn:function(e,r){return i("div",{},[i("div",{staticStyle:{width:"1rem",height:"100%","min-height":".6rem",margin:"0 auto"},style:{background:"url("+r.image+") center center","background-size":"窗帘"===r.parent_category_name?"":"100%"}}),i("div",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(r.name))])])}},{key:"param",fn:function(e,r){return i("div",{},[i("div",{staticStyle:{"font-weight":"bold","font-size":".10rem"}},[t._v(" "+t._s(r.category_name?"《"+r.category_name+"》":""))]),i("div",{staticStyle:{"font-weight":"bold","font-size":".11rem"}},[t._v(" "+t._s(r.parent_category_name)+" ")]),i("div",[t._v(t._s(r.product_attribute))])])}},{key:"price",fn:function(e,r){return["fuliao"===r.from?i("div",[i("a-input-number",{staticStyle:{"text-align":"center","font-size":".12rem",width:".8rem"},attrs:{step:.1,min:.1,max:999},model:{value:r.price,callback:function(e){t.$set(r,"price",e)},expression:"record.price"}}),i("div",{staticStyle:{"font-weight":"bold","font-size":".11rem"}},[t._v("元每"+t._s(r.unit))])],1):i("div",{staticStyle:{"font-weight":"bold","font-size":".11rem"}},[i("div",[t._v("¥"+t._s(r.price.toFixed(2)))]),i("div",[t._v("每"+t._s(r.unit))])])]}},{key:"num",fn:function(e,r){return[0==r.num?i("a-input-number",{staticStyle:{"text-align":"center","font-size":".12rem",width:".8rem",border:"solid 2px red"},attrs:{step:.1,min:0,max:999},model:{value:r.num,callback:function(e){t.$set(r,"num",e)},expression:"record.num"}}):i("a-input-number",{staticStyle:{"text-align":"center","font-size":".12rem",width:".8rem"},attrs:{step:.1,min:.1,max:999},model:{value:r.num,callback:function(e){t.$set(r,"num",e)},expression:"record.num"}})]}},{key:"discount",fn:function(e,r){return[i("a-input-number",{directives:[{name:"show",rawName:"v-show",value:1==r.product_offer_status,expression:"record.product_offer_status == 1"}],staticStyle:{"text-align":"center","font-size":".12rem",width:".8rem"},attrs:{"default-value":100,step:5,min:10,max:100,formatter:function(t){return t+"%"}},model:{value:r.discount,callback:function(e){t.$set(r,"discount",e)},expression:"record.discount"}}),i("p",{directives:[{name:"show",rawName:"v-show",value:0==r.product_offer_status,expression:"record.product_offer_status == 0"}],staticStyle:{"font-size":"0.10rem",margin:"0 auto"}},[t._v("暂无折扣")])]}},{key:"total",fn:function(e,r){return i("div",{},[i("div",{staticStyle:{"font-size":".13rem","font-weight":"bold",color:"#ff4d4f"}},[t._v("¥"+t._s(t.rowTotal(r)))])])}},{key:"operation",fn:function(e,r,n){return[i("a-icon",{style:{fontSize:".2rem"},attrs:{type:"delete",theme:"twoTone","two-tone-color":"#f40c0c"},on:{click:function(e){return t.handleDel(n)}}})]}}])})],1),i("div",{staticClass:"fixed-total",staticStyle:{height:"0.5rem",background:"rgb(255, 255, 255) none repeat scroll 0% 0%","border-top":"1px solid #ecebeb"}},[i("div",{staticStyle:{"font-size":".14rem","padding-right":".1rem","font-weight":"bold"}},[t._v("整单折扣：")]),i("a-slider",{staticStyle:{width:"25%"},attrs:{tipFormatter:function(t){return t+"%"},"default-value":100,step:5,min:10,max:100,formatter:function(t){return t+"%"}},model:{value:t.totalDiscount,callback:function(e){t.totalDiscount=e},expression:"totalDiscount"}}),i("a-input-number",{staticStyle:{"font-size":".14rem",color:"#1890ff","margin-left":".2rem","margin-right":".1rem"},attrs:{"default-value":100,step:5,min:10,max:100,formatter:function(t){return t+"%"}},model:{value:t.totalDiscount,callback:function(e){t.totalDiscount=e},expression:"totalDiscount"}}),i("div",{staticStyle:{"font-size":".16rem","font-weight":"bold",width:"10%","text-align":"right"}},[t._v("合计:")]),i("div",{staticStyle:{"font-size":".16rem","font-weight":"bold",color:"#ff4d4f","margin-left":"10px",width:"10%","text-align":"left"}},[t._v(" ¥"+t._s(t.total()))])],1)],1)},n=[],o=i("5530"),a=(i("7db0"),i("d3b7"),i("25f0"),i("b680"),i("a9e3"),i("d81d"),i("159b"),i("4de4"),i("ac1f"),i("1276"),i("5319"),i("a434"),i("e73e")),s=[{title:"产品图",dataIndex:"image",width:"20%",align:"center",scopedSlots:{customRender:"image"}},{title:"属性",dataIndex:"",width:"15%",align:"center",scopedSlots:{customRender:"param"}},{title:"单价",dataIndex:"",width:"10%",align:"center",scopedSlots:{customRender:"price"}},{title:"数量",dataIndex:"num",width:"10%",align:"center",scopedSlots:{customRender:"num"}},{title:"单品折扣",dataIndex:"discount",width:"15%",align:"center",scopedSlots:{customRender:"discount"}},{title:"合计",dataIndex:"total",width:"20%",align:"center",scopedSlots:{customRender:"total"}},{title:"操作",width:"10%",dataIndex:"operation",align:"center",scopedSlots:{customRender:"operation"}}],c={components:{layoutTop:a["a"]},data:function(){return{id:"",canAdd:!0,showSelect:!1,inputValue1:1,totalDiscount:100,product_offer_status:!1,columns:s,offerImage:"",fuliaoList:[],defaultFuliaoId:"",filiaoId:"",productList:[],init:!0,showEdit:!0,temp:{customer_name:"",customer_mobile:"",offer_remark:""},userForm:{customer_name:"",customer_mobile:"",offer_remark:""}}},mounted:function(){this.id=this.$route.query.id,this.loadData(),this.loadfuliaoList()},methods:{onClose:function(){this.showSelect=!1},handleOpenAdd:function(){this.showSelect=!0,this.defaultFuliaoId=this.fuliaoList[0].id},handleChange:function(t){this.filiaoId=t},handleConfirm:function(){var t=this;if(!this.filiaoId)return this.$message.warning("请在下拉菜单选择辅料");var e=this.fuliaoList.find((function(e){return e.id==(t.filiaoId||t.defaultFuliaoId)}));this.productList.push(Object(o["a"])(Object(o["a"])({},e),{},{from:"fuliao",num:1,key:this.productList.length.toString()})),this.showSelect=!1,this.filiaoId=""},handleCancel:function(){this.showSelect=!1,this.filiaoId=""},rowTotal:function(t){var e=t.price*t.num*t.discount/100;return e>0?e.toFixed(2):0},total:function(){for(var t=0,e=0;e<this.productList.length;e++)t+=Number(this.rowTotal(this.productList[e]));return t*=this.totalDiscount/100,t.toFixed(2)},loadfuliaoList:function(){var t=this;this.$service.chuanglianfuliaoList().then((function(e){t.fuliaoList=e.data.map((function(t){return Object(o["a"])(Object(o["a"])({},t),{},{image:t.pre_img,discount:100,num:0,parent_category_name:"辅料",product_offer_status:0})}))}))},loadData:function(){var t=this;this.loading=!0,this.$service.userRoomFinishedDetail({id:this.id}).then((function(e){t.loading=!1,t.offerImage=e.image,t.id=e.id,e.product_list.forEach((function(t){t.discount=100})),t.temp.customer_mobile=e.customer_mobile,t.temp.customer_name=e.customer_name,t.productList=e.product_list.map((function(t,e){return Object(o["a"])(Object(o["a"])({},t),{},{key:e.toString()})})),t.canAdd=t.productList.filter((function(t){return 1==t.parent_category_id||14==t.parent_category_id})).length>0})).catch((function(e){t.loading=!1}))},saveUserOffer:function(){var t=this,e=this;if(0===this.productList.length)return this.$message.error("您还没有添加任何商品，请到云设计报价");if(!this.temp.customer_name||!this.temp.customer_mobile)return this.$message.error("请输入客户姓名和电话");if(this.temp.customer_mobile.length<11)return this.$message.error("请输入正确的电话号码");if(this.temp.customer_name&&this.temp.customer_mobile){var i=this.productList.every((function(t){return t.num&&t.num>0}));if(!i)return this.$message.error("数量不能为0或者空");this.$service.saveUserOffer({user_room_finished_id:this.id,offer_image:this.offerImage,product_list:this.productList,customer_name:this.temp.customer_name,customer_mobile:this.temp.customer_mobile,offer_remark:this.temp.offer_remark,totalDiscount:this.totalDiscount}).then((function(e){t.$message.success("保存成功"),t.$router.push({path:"/offerDetail",query:{id:e.id}})})).catch((function(t){return console.log("saveUserOffer",t),e.$message.error("保存失败")}))}else e.$message.error("请填写客户信息")},handleAdd:function(){return this.temp.customer_name&&this.temp.customer_mobile?this.temp.customer_mobile.length<11?this.$message.error("请输入正确的电话号码"):(this.userForm={customer_name:this.temp.customer_name,customer_mobile:this.temp.customer_mobile,offer_remark:this.temp.offer_remark},void(this.showEdit=!1)):this.$message.error("请输入客户姓名和客户电话")},accMul:function(t,e){var i=0,r=t.toString(),n=e.toString();try{i+=r.split(".")[1].length}catch(o){}try{i+=n.split(".")[1].length}catch(o){}return Number(r.replace(".",""))*Number(n.replace(".",""))/Math.pow(10,i)},handleDel:function(t){var e=this;this.$confirm({title:"确认",content:"是否删除所选产品",okText:"确认",cancelText:"取消",onOk:function(){e.productList.splice(t,1)},onCancel:function(){console.log("取消")}})}}},l=c,u=(i("0d56"),i("0ab7"),i("2877")),f=Object(u["a"])(l,r,n,!1,null,"17c059f2",null);e["default"]=f.exports},a9e3:function(t,e,i){"use strict";var r=i("83ab"),n=i("da84"),o=i("94ca"),a=i("6eeb"),s=i("5135"),c=i("c6b6"),l=i("7156"),u=i("c04e"),f=i("d039"),d=i("7c73"),m=i("241c").f,h=i("06cf").f,p=i("9bf2").f,g=i("58a8").trim,v="Number",b=n[v],_=b.prototype,y=c(d(_))==v,w=function(t){var e,i,r,n,o,a,s,c,l=u(t,!1);if("string"==typeof l&&l.length>2)if(l=g(l),e=l.charCodeAt(0),43===e||45===e){if(i=l.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+l}for(o=l.slice(2),a=o.length,s=0;s<a;s++)if(c=o.charCodeAt(s),c<48||c>n)return NaN;return parseInt(o,r)}return+l};if(o(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var x,S=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof S&&(y?f((function(){_.valueOf.call(i)})):c(i)!=v)?l(new b(w(e)),i,S):w(e)},k=r?m(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),I=0;k.length>I;I++)s(b,x=k[I])&&!s(S,x)&&p(S,x,h(b,x));S.prototype=_,_.constructor=S,a(n,v,S)}},b680:function(t,e,i){"use strict";var r=i("23e7"),n=i("a691"),o=i("408a"),a=i("1148"),s=i("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,i){return 0===e?i:e%2===1?u(t,e-1,i*t):u(t*t,e/2,i)},f=function(t){var e=0,i=t;while(i>=4096)e+=12,i/=4096;while(i>=2)e+=1,i/=2;return e},d=function(t,e,i){var r=-1,n=i;while(++r<6)n+=e*t[r],t[r]=n%1e7,n=l(n/1e7)},m=function(t,e){var i=6,r=0;while(--i>=0)r+=t[i],t[i]=l(r/e),r=r%e*1e7},h=function(t){var e=6,i="";while(--e>=0)if(""!==i||0===e||0!==t[e]){var r=String(t[e]);i=""===i?r:i+a.call("0",7-r.length)+r}return i},p=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));r({target:"Number",proto:!0,forced:p},{toFixed:function(t){var e,i,r,s,c=o(this),l=n(t),p=[0,0,0,0,0,0],g="",v="0";if(l<0||l>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(g="-",c=-c),c>1e-21)if(e=f(c*u(2,69,1))-69,i=e<0?c*u(2,-e,1):c/u(2,e,1),i*=4503599627370496,e=52-e,e>0){d(p,0,i),r=l;while(r>=7)d(p,1e7,0),r-=7;d(p,u(10,r,1),0),r=e-1;while(r>=23)m(p,1<<23),r-=23;m(p,1<<r),d(p,1,1),m(p,2),v=h(p)}else d(p,0,i),d(p,1<<-e,0),v=h(p)+a.call("0",l);return l>0?(s=v.length,v=g+(s<=l?"0."+a.call("0",l-s)+v:v.slice(0,s-l)+"."+v.slice(s-l))):v=g+v,v}})},dbeb:function(t,e,i){},e2cd:function(t,e,i){},e73e:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"my-layout-top"},[i("h4",[t._v(t._s(t.name))]),i("div",{staticClass:"back-btn",on:{click:t.goBack}},[i("a-icon",{staticStyle:{"vertical-align":"middle"},style:{fontSize:"0.23rem"},attrs:{type:"left-circle",theme:"filled"}})],1),i("div",{staticClass:"my-layout-top-right flex-box"},[i("div",{staticClass:"my-layout-top-op"},[t._t("default")],2)])])},n=[],o=(i("ac1f"),i("5319"),{props:{name:{type:String,default:""},backTo:String,baojiaheader:""},data:function(){return{}},methods:{goBack:function(){this.backTo?this.$router.replace(this.backTo):"qingdan"==this.baojiaheader?this.$router.push("/priceRecord"):this.$router.push("home/userinfo")}}}),a=o,s=(i("80f9"),i("2877")),c=Object(s["a"])(a,r,n,!1,null,null,null);e["a"]=c.exports},eec7:function(t,e,i){}}]);